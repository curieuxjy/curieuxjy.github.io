{
  "hash": "15011d7f23b17efcf31af3429981be46",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"ğŸ“Async vs Sync in Python\"\njupyter: python3\ntoc: true\ndate: \"2025-10-20\"\ndescription: Async defì— ëŒ€í•´ ì•Œì•„ë³´ê¸°\ncategories: [python, async, 2025]\nformat:\n  html:\n    mermaid:\n      theme: dark\nexecute:\n  echo: true\n  warning: true\n---\n\n`async def`ì™€ `def`ì˜ ì°¨ì´ëŠ” **í•¨ìˆ˜ì˜ ì‹¤í–‰ ë°©ì‹(ë™ê¸° vs ë¹„ë™ê¸°)**ì— ìˆì–´ìš”.\n\n## ğŸ§© ê¸°ë³¸ ê°œë…\n\n| êµ¬ë¶„ | `def` (ì¼ë°˜ í•¨ìˆ˜) | `async def` (ë¹„ë™ê¸° í•¨ìˆ˜) |\n|---|---|---|\n| ì‹¤í–‰ ë°©ì‹ | **ë™ê¸°(Synchronous)** | **ë¹„ë™ê¸°(Asynchronous)** |\n| ë°˜í™˜ ê°’ | ì¼ë°˜ì ì¸ ê°’ (ì˜ˆ: `int`, `list`) | **ì½”ë£¨í‹´ ê°ì²´ (`coroutine`)** |\n| ì‹¤í–‰ ì‹œì  | ì¦‰ì‹œ ì‹¤í–‰ë˜ì–´ ê²°ê³¼ë¥¼ ë°˜í™˜ | ì‹¤í–‰ë˜ì§€ë§Œ **`await`ë¡œ ê¸°ë‹¤ë ¤ì•¼** ì‹¤ì œ ê²°ê³¼ë¥¼ ì–»ìŒ |\n\n---\n\n## âš™ï¸ ì˜ˆì‹œ ë¹„êµ\n\n### (1) ì¼ë°˜ í•¨ìˆ˜ (`def`)\n\n::: {#05c0d0bf .cell execution_count=1}\n``` {.python .cell-code}\ndef greet():\n    return \"Hello\"\n\nresult = greet()\nprint(result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nHello\n```\n:::\n:::\n\n\n> `def`ëŠ” í˜¸ì¶œë˜ë©´ ë°”ë¡œ ì‹¤í–‰ë˜ê³  ê²°ê³¼ë¥¼ ë°˜í™˜í•´ìš”.\n\n\n### (2) ë¹„ë™ê¸° í•¨ìˆ˜ (`async def`)\n\n::: {#e1241da3 .cell execution_count=2}\n``` {.python .cell-code}\nimport asyncio\n\nasync def greet():\n    return \"Hello\"\n\nresult = greet()\nprint(result)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<coroutine object greet at 0x73214c2a6610>\n```\n:::\n:::\n\n\n- `async def`ë¡œ ì •ì˜ëœ í•¨ìˆ˜ëŠ” **ì¦‰ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ**\n- ëŒ€ì‹  â€œì½”ë£¨í‹´(coroutine)â€ ê°ì²´ë¥¼ ë°˜í™˜\n- ì‹¤ì œ ì‹¤í–‰í•˜ë ¤ë©´ `await` ë˜ëŠ” `asyncio.run()`ì„ ì¨ì•¼ í•¨\n\n---\n\n#### `await`ë¡œ ì‹¤í–‰í•˜ê¸°\n\n::: {#d330abd9 .cell execution_count=3}\n``` {.python .cell-code}\nimport asyncio  # âœ… asyncio: íŒŒì´ì¬ì˜ ë¹„ë™ê¸°(Asynchronous) í”„ë¡œê·¸ë˜ë°ì„ ì§€ì›í•˜ëŠ” í‘œì¤€ ëª¨ë“ˆ\n\n# ============================================================\n# â‘  ì½”ë£¨í‹´(Coroutine) ì •ì˜\n# ============================================================\n# async def ë¡œ ì •ì˜ëœ í•¨ìˆ˜ëŠ” ì¼ë°˜ í•¨ìˆ˜ì²˜ëŸ¼ ì¦‰ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ.\n# í˜¸ì¶œ ì‹œ 'ì½”ë£¨í‹´ ê°ì²´(coroutine object)'ë¥¼ ë°˜í™˜í•˜ê³ ,\n# ì´ ê°ì²´ë¥¼ ì´ë²¤íŠ¸ ë£¨í”„(event loop)ê°€ ìŠ¤ì¼€ì¤„ë§í•´ì„œ ì‹¤ì œë¡œ ì‹¤í–‰í•¨.\nasync def greet():\n    # ì´ í•¨ìˆ˜ëŠ” ë‹¨ìˆœíˆ \"Hello\" ë¬¸ìì—´ì„ ë°˜í™˜í•˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜\n    return \"Hello\"\n\n\n# ============================================================\n# â‘¡ ë©”ì¸ ì½”ë£¨í‹´ (ë‹¤ë¥¸ ì½”ë£¨í‹´ì„ í˜¸ì¶œí•˜ê³  ê´€ë¦¬)\n# ============================================================\nasync def main():\n    # await í‚¤ì›Œë“œëŠ” 'ì½”ë£¨í‹´ ì‹¤í–‰ ê²°ê³¼ë¥¼ ê¸°ë‹¤ë¦°ë‹¤'ëŠ” ì˜ë¯¸.\n    # greet()ë¥¼ í˜¸ì¶œí•˜ë©´ ì¦‰ì‹œ ì‹¤í–‰ë˜ëŠ” ê²Œ ì•„ë‹ˆë¼ ì½”ë£¨í‹´ ê°ì²´ë¥¼ ë°˜í™˜í•¨.\n    # await greet()ëŠ” ì´ë²¤íŠ¸ ë£¨í”„ì—ê²Œ \"ì´ ì½”ë£¨í‹´ì„ ì‹¤í–‰í•˜ê³  ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì¤˜\"ë¼ê³  ìš”ì²­í•¨.\n    result = await greet()\n\n    # greet()ì˜ ì‹¤í–‰ì´ ì™„ë£Œë˜ë©´, resultì—ëŠ” \"Hello\"ê°€ ì €ì¥ë¨.\n    print(result)  # ì½˜ì†”ì— \"Hello\" ì¶œë ¥\n\n\n# ============================================================\n# â‘¢ ì´ë²¤íŠ¸ ë£¨í”„(Event Loop)\n# ============================================================\n# asyncio.run()ì€ íŒŒì´ì¬ 3.7ë¶€í„° ë„ì…ëœ ê³ ìˆ˜ì¤€ APIë¡œ,\n# ë‚´ë¶€ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ì„ ìˆ˜í–‰í•¨:\n#\n#  1ï¸âƒ£ ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ë£¨í”„ ìƒì„±\n#  2ï¸âƒ£ main() ì½”ë£¨í‹´ì„ ë£¨í”„ì— ë“±ë¡í•˜ê³  ì‹¤í–‰ ì‹œì‘\n#  3ï¸âƒ£ await êµ¬ë¬¸ ë“±ì„ í†µí•´ ë‹¤ë¥¸ ì½”ë£¨í‹´ë“¤ì„ ìŠ¤ì¼€ì¤„ë§í•˜ì—¬ ì‹¤í–‰ ìˆœì„œë¥¼ ê´€ë¦¬\n#  4ï¸âƒ£ ëª¨ë“  ì½”ë£¨í‹´ì´ ì™„ë£Œë˜ë©´ ë£¨í”„ë¥¼ ì •ë¦¬í•˜ê³  ì¢…ë£Œ\n#\n# ì¦‰, í”„ë¡œê·¸ë¨ ì „ì²´ì˜ ë¹„ë™ê¸° ì‘ì—…ì„ ì´ê´„í•˜ëŠ” \"ì¡°ì •ì\" ì—­í• ì„ í•¨.\nasyncio.run(main())\n```\n:::\n\n\nğŸ“Œ ì‹¤í–‰ ê²°ê³¼\n\n```\nHello\n```\n\nì´ë²¤íŠ¸ ë£¨í”„ ë‚´ë¶€ êµ¬ì„±ì„ ë‚˜íƒ€ë‚´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\n\n```{mermaid}\n%%| echo: false\n\nflowchart TD\n    %% =============================\n    %% asyncio (High-level)\n    %% =============================\n    subgraph A[\"asyncio (ê³ ìˆ˜ì¤€ API)\"]\n        A1[\"asyncio.run(main)\"]\n        A2[\"ë£¨í”„ ìƒì„± ë°<br>run_until_complete(Task(main))\"]\n        A3[\"Task<br>ì½”ë£¨í‹´ ì‹¤í–‰ ë‹¨ìœ„<br>(ìƒíƒœ/ì½œë°±/ìŠ¤íƒ ë³´ìœ )\"]\n        A4[\"Future<br>ê²°ê³¼Â·ì˜ˆì™¸ ì €ì¥, ì½œë°± ë“±ë¡ ê°€ëŠ¥\"]\n\n        A1 --> A2\n        A2 --> A3\n        A2 --> A4\n    end\n\n    %% =============================\n    %% Event Loop ë‚´ë¶€ êµ¬ì¡°\n    %% =============================\n    subgraph B[\"Event Loop (ë‹¨ì¼ ìŠ¤ë ˆë“œ, í˜‘ë ¥í˜• ì „í™˜)\"]\n        direction LR\n        B1[\"Ready Queue\"]\n        B2[\"Callback Queue\"]\n        B3[\"ì‹¤í–‰ ë‹¨ê³„<br>(í•œ í‹±ì”© Task ì‹¤í–‰)\"]\n        B5[\"Selector / IO<br>(epoll, kqueue)\"]\n        B6[\"íƒ€ì´ë¨¸ í™<br>(ì§€ì—° ì½œë°±, sleep)\"]\n\n        B1 <-->|\"ì½œë°± ì´ë™\"| B2\n        B2 -->|\"run_ready()\"| B3\n        B5 <-->|\"poll(timeout)\"| B3\n        B3 --> B6\n    end\n\n    %% =============================\n    %% Control Flow\n    %% =============================\n    A3 -. \"await\" .-> B3\n    B3 -. \"I/O ì™„ë£ŒÂ·íƒ€ì´ë¨¸ ë§Œë£Œ\" .-> B1\n    B1 -->|\"Task ì¬ê°œ\"| A3\n\n\n```\n\n---\n\n## â±ï¸ ì–¸ì œ `async def`ë¥¼ ì¨ì•¼ í• ê¹Œ?\n\në¹„ë™ê¸°ëŠ” **I/O ì‘ì—…(ì…ì¶œë ¥)**ì´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ì€ ìƒí™©ì—ì„œ ìœ ìš©í•©ë‹ˆë‹¤.\n\n* ë„¤íŠ¸ì›Œí¬ ìš”ì²­ (`HTTP request`)\n* íŒŒì¼ ì½ê¸°/ì“°ê¸°\n* ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬\n* ëŒ€ê¸° ì‹œê°„(`sleep`)ì´ ë§ì€ ì½”ë“œ\n\n::: {#d98b801f .cell execution_count=4}\n``` {.python .cell-code}\nimport asyncio\n\nasync def download():\n    print(\"ë‹¤ìš´ë¡œë“œ ì‹œì‘\")\n    await asyncio.sleep(2)   # ë„¤íŠ¸ì›Œí¬ ëŒ€ê¸°\n    print(\"ë‹¤ìš´ë¡œë“œ ì™„ë£Œ\")\n\nasync def main():\n    await asyncio.gather(download(), download(), download())\n\nasyncio.run(main())\n```\n:::\n\n\nğŸ“Œ ì‹¤í–‰ ê²°ê³¼\n\n```\në‹¤ìš´ë¡œë“œ ì‹œì‘\në‹¤ìš´ë¡œë“œ ì‹œì‘\në‹¤ìš´ë¡œë“œ ì‹œì‘\n(2ì´ˆ í›„)\në‹¤ìš´ë¡œë“œ ì™„ë£Œ\në‹¤ìš´ë¡œë“œ ì™„ë£Œ\në‹¤ìš´ë¡œë“œ ì™„ë£Œ\n```\n\n> ì„¸ ê°œê°€ ë™ì‹œì— ì‹¤í–‰ë˜ì–´ **ì´ 2ì´ˆë§Œ ê±¸ë ¤ìš”!**\n> ë§Œì•½ `def`ì˜€ë‹¤ë©´ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë˜ì–´ 6ì´ˆê°€ ê±¸ë ¸ì„ ê²ë‹ˆë‹¤.\n\n\n\n| í•­ëª©    | `def`        | `async def`                  |\n| ----- | ------------ | ---------------------------- |\n| ì‹¤í–‰ ì‹œì  | ì¦‰ì‹œ ì‹¤í–‰        | ì½”ë£¨í‹´ ê°ì²´ ë°˜í™˜                    |\n| ë°˜í™˜ ê°’  | ì¼ë°˜ ê°’         | `coroutine`                  |\n| ê²°ê³¼ ë°›ê¸° | ë°”ë¡œ ê°€ëŠ¥        | `await` í•„ìš”                   |\n| ì£¼ ìš©ë„  | CPU ì—°ì‚° ì¤‘ì‹¬ ì½”ë“œ | I/O ì¤‘ì‹¬(ëŒ€ê¸° ë§ì€) ì½”ë“œ             |\n| ë³‘ë ¬ ì²˜ë¦¬ | ì–´ë µë‹¤          | `asyncio.gather()` ë“±ìœ¼ë¡œ ì‰½ê²Œ ê°€ëŠ¥ |\n\n---\n\n<!--\nì´ì œë¶€í„°ëŠ” **ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ” ë°ëª¨**ë¥¼ ë³´ì—¬ì¤„ê²Œìš”.\nQuarto/Jupyterì—ì„œì˜ ì´ë²¤íŠ¸ ë£¨í”„ ì¶©ëŒì„ í”¼í•˜ê¸° ìœ„í•´ `nest_asyncio`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\n\n\n> âœ… ì‹¤í–‰ ì¤€ë¹„\n\n::: {#176d0abe .cell execution_count=5}\n``` {.python .cell-code}\nimport sys, subprocess, importlib\n\ndef ensure(pkg: str):\n    try:\n        importlib.import_module(pkg)\n    except ImportError:\n        subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", pkg])\n\nensure(\"nest_asyncio\")\n```\n:::\n\n\n-->\n\n## ğŸš€ ë™ê¸° vs ë¹„ë™ê¸° ì‹¤í–‰ ë°ëª¨\n\n::: {#aed6d7ef .cell execution_count=6}\n``` {.python .cell-code}\nimport asyncio\nimport time\n\n# ------------------ ë™ê¸° (def) ------------------\ndef sync_task(name):\n    print(f\"{name} ì‹œì‘\")\n    time.sleep(2)\n    print(f\"{name} ì™„ë£Œ\")\n\ndef sync_main():\n    start = time.time()\n    for i in range(3):\n        sync_task(f\"ì‘ì—… {i+1}\")\n    print(f\"ì´ ì†Œìš” ì‹œê°„(ë™ê¸°): {time.time() - start:.2f}ì´ˆ\")\n\n# ------------------ ë¹„ë™ê¸° (async def) ------------------\nasync def async_task(name):\n    print(f\"{name} ì‹œì‘\")\n    await asyncio.sleep(2)\n    print(f\"{name} ì™„ë£Œ\")\n\nasync def async_main():\n    start = time.time()\n    await asyncio.gather(*[async_task(f\"ì‘ì—… {i+1}\") for i in range(3)])\n    print(f\"ì´ ì†Œìš” ì‹œê°„(ë¹„ë™ê¸°): {time.time() - start:.2f}ì´ˆ\")\n\nprint(\"\\n=== ë™ê¸° ì‹¤í–‰ ===\")\nsync_main()\n\nprint(\"\\n=== ë¹„ë™ê¸° ì‹¤í–‰ ===\")\n# ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ ë£¨í”„ì—ì„œ ì•ˆì „í•˜ê²Œ ì‹¤í–‰ (top-level await)\nawait async_main()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n=== ë™ê¸° ì‹¤í–‰ ===\nì‘ì—… 1 ì‹œì‘\nì‘ì—… 1 ì™„ë£Œ\nì‘ì—… 2 ì‹œì‘\nì‘ì—… 2 ì™„ë£Œ\nì‘ì—… 3 ì‹œì‘\nì‘ì—… 3 ì™„ë£Œ\nì´ ì†Œìš” ì‹œê°„(ë™ê¸°): 6.00ì´ˆ\n\n=== ë¹„ë™ê¸° ì‹¤í–‰ ===\nì‘ì—… 1 ì‹œì‘\nì‘ì—… 2 ì‹œì‘\nì‘ì—… 3 ì‹œì‘\nì‘ì—… 1 ì™„ë£Œ\nì‘ì—… 2 ì™„ë£Œ\nì‘ì—… 3 ì™„ë£Œ\nì´ ì†Œìš” ì‹œê°„(ë¹„ë™ê¸°): 2.00ì´ˆ\n```\n:::\n:::\n\n\n## ğŸ” ê²°ê³¼ í•´ì„\n\n* **ë™ê¸°(`def`)**: 1â†’2â†’3 ìˆœì°¨ ì‹¤í–‰ â†’ ì•½ **6ì´ˆ**\n* **ë¹„ë™ê¸°(`async def`)**: 3ê°œ ë™ì‹œ ì‹¤í–‰ â†’ ì•½ **2ì´ˆ**\n\në¹„ë™ê¸°ëŠ” **ëŒ€ê¸°(I/O)** ì‹œê°„ì´ ë§ì€ ì‘ì—…ì—ì„œ í° ì´ì ì„ ì œê³µí•©ë‹ˆë‹¤.\n\n",
    "supporting": [
      "2025-10-20-async-def_files"
    ],
    "filters": [],
    "includes": {}
  }
}