<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-08-07">
<meta name="description" content="Graph Networks as Learnable Physics Engines for Inference and Control">

<title>ğŸ“ƒGN-Block ë¦¬ë·° â€“ Curieux.JY</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../profile.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-ecf89aac047581c664da7ae53d704519.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-b009f778f5cec7f34f624408a2b5b543.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-ecf89aac047581c664da7ae53d704519.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-2NVZN2MJZT"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-2NVZN2MJZT', { 'anonymize_ip': true});
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Curieux.JY</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../post.html"> 
<span class="menu-text">Post</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../note.html"> 
<span class="menu-text">Note</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Jung Yeon Lee</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/curieuxjy"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">1. Introduction</a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">2. Model</a>
  <ul class="collapse">
  <li><a href="#graph-representation-of-a-physical-system" id="toc-graph-representation-of-a-physical-system" class="nav-link" data-scroll-target="#graph-representation-of-a-physical-system">Graph representation of a physical system</a></li>
  <li><a href="#static-dynamic-properties" id="toc-static-dynamic-properties" class="nav-link" data-scroll-target="#static-dynamic-properties">Static &amp; Dynamic properties</a></li>
  <li><a href="#graph-networks" id="toc-graph-networks" class="nav-link" data-scroll-target="#graph-networks">Graph networks</a></li>
  <li><a href="#forward-models" id="toc-forward-models" class="nav-link" data-scroll-target="#forward-models">Forward models</a></li>
  <li><a href="#inference-models" id="toc-inference-models" class="nav-link" data-scroll-target="#inference-models">Inference Models</a></li>
  <li><a href="#control-algorithm" id="toc-control-algorithm" class="nav-link" data-scroll-target="#control-algorithm">Control algorithm</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">3. Methods</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">4. Results</a>
  <ul class="collapse">
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction">Prediction</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  <li><a href="#control" id="toc-control" class="nav-link" data-scroll-target="#control">Control</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">5. Discussion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ğŸ“ƒGN-Block ë¦¬ë·°</h1>
  <div class="quarto-categories">
    <div class="quarto-category">gnn</div>
    <div class="quarto-category">system identification</div>
    <div class="quarto-category">mpc</div>
    <div class="quarto-category">rl</div>
    <div class="quarto-category">paper</div>
  </div>
  </div>

<div>
  <div class="description">
    Graph Networks as Learnable Physics Engines for Inference and Control
  </div>
</div>


<div class="quarto-title-meta column-page-left">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 7, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>ì´ë²ˆ postëŠ” <a href="https://arxiv.org/abs/1806.01242">Graph Networks as Learnable Physics Engines for Inference and Control</a> ë¼ëŠ” ë…¼ë¬¸ì„ ì½ê³  ë¦¬ë·°í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
<section id="abstract" class="level1">
<h1>Abstract</h1>
<blockquote class="blockquote">
<p>Understanding and interacting with everyday physical scenes requires rich knowledge about the structure of the world, represented either implicitly in a value or policy function, or explicitly in a transition model. Here we introduce a new class of learnable modelsâ€”<code>based on graph networksâ€”which implement an inductive bias</code> for object- and relation-centric representations of complex, dynamical systems. Our results show that as a <code>forward model</code>, our approach supports accurate predictions from real and simulated data, and surprisingly strong and efficient generalization, across eight distinct physical systems which we varied parametrically and structurally. We also found that our <code>inference model</code> can perform system identification. Our models are also <code>differentiable, and support online planning via gradient-based trajectory optimization</code>, as well as <code>offline policy optimization</code>. Our framework offers new opportunities for harnessing and exploiting rich knowledge about the world and takes a key step toward building machines with <code>more human-like representations of the world</code>.</p>
</blockquote>
</section>
<section id="introduction" class="level1">
<h1>1. Introduction</h1>
<p>ì‚¬ëŒì€ ê±¸ì„ë•Œ ë§ˆì°°ë ¥, ì‘ìš© ë°˜ì‘ìš© ë²•ì¹™ì„ ìƒê°í•˜ë©´ì„œ ê±·ì§€ ì•ŠìŠµë‹ˆë‹¤. ë§ì€ ë¬¼ë¦¬ ë¬¸ì œë“¤ê³¼ ë²•ì¹™ë“¤ì„ ì´í•´í•˜ê¸° ì–´ë µì§€ë§Œ ë³µì¡í•œ ë¬¼ë¦¬ì  ì‘ìš©ë“¤ì´ ì¼ì–´ë‚˜ëŠ” ê±·ëŠ” í–‰ë™ì— ìˆì–´ì„œ ì–´ë ¤ì›€ì´ ì—†ìŠµë‹ˆë‹¤. ì‚¬ì‹¤ ì‚¬ëŒì´ íƒœì–´ë‚˜ì„œ ìˆ˜ì—†ì´ ë§ì€ ê²½í—˜ë“¤ì˜ ëˆ„ì ìœ¼ë¡œ ìš°ë¦¬ëŠ” í¬ê²Œ ì‹ ê²½ì“°ì§€ ì•Šì•„ë„ ì–´ë–»ê²Œ í˜ì„ ì£¼ë©´ ë‹¤ë¦¬ê°€ ì›€ì§ì´ëŠ” ì§€ ì•Œê³ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ì²˜ëŸ¼ ì¸ê³µì§€ëŠ¥ë„ <em>ì–´ë–»ê²Œ í•˜ë©´ ë³µì¡í•œ ì‹œìŠ¤í…œì„ ì´í•´í•˜ê³  ì˜ ì‘ë™í•  ìˆ˜ ìˆì„ê¹Œ?</em> ë¼ëŠ” ë¬¼ìŒì„ <strong>GN-Block</strong>ì´ë¼ëŠ” Graph ì•„ì´ë””ì–´ë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤ê³  ì£¼ì¥í•˜ëŠ” ë…¼ë¬¸ì…ë‹ˆë‹¤.</p>
<pre><code>â“ How can an intelligent agent understand and control such complex systems?</code></pre>
<p>ì¸ê³µì§€ëŠ¥ì´ ì´ë ‡ê²Œ ì‚¬ëŒì´ ìì—°ìŠ¤ëŸ½ê²Œ ìµíˆëŠ” ì„¸ìƒì˜ ë¬¼ë¦¬ì ì¸ í˜„ìƒì„ ì´í•´í•˜ê³  ìƒí˜¸ì‘ìš© ì‘ìš©í•˜ë ¤ë©´ ì•”ì‹œì ì´ë“  ëª…ì‹œì ìœ¼ë¡œë“  ì„¸ê³„ì— ëŒ€í•œ í’ë¶€í•œ(rich) í‘œí˜„ê³¼ ì§€ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´, ì‹œìŠ¤í…œì— ìˆëŠ” objectsë“¤ê³¼ objectsê°„ì˜ ê´€ê³„ë¥¼ í‘œí˜„í•´ì„œ ë™ì¼ objectì—ëŠ” ë™ì¼í•œ <strong>object-wiseí•œ ê³„ì‚°</strong>ì„, ì´ë“¤ ì‚¬ì´ì— ì¼ì–´ë‚˜ëŠ” interationë“¤ì— ëŒ€í•´ì„œëŠ” <strong>relation-wise ê³„ì‚°</strong>ì„ ì ìš©í•´ì„œ í•™ìŠµì„ í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë§ˆì¹˜ ë ˆê³  ë¸”ëŸ­ë“¤ í•˜ë‚˜í•˜ë‚˜ë¥¼ ì´í•´í•˜ê³  ì–´ë–»ê²Œ í•˜ë©´ ì„±ì„ ìŒ“ì„ ìˆ˜ ìˆëŠ”ì§€ ì•„ëŠ” ê²ƒì²˜ëŸ¼ <code>combinatorial generalization</code> ëŠ¥ë ¥ì„ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ê²ƒì´ë¼ê³  ìƒê°í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>í•´ë‹¹ ë…¼ë¬¸ì˜ ëª©í‘œëŠ” <strong>physical dynamics modelsì„ ê·¸ë˜í”„ ê¸°ë°˜ì˜ ë°©ë²•ìœ¼ë¡œ í•™ìŠµ</strong>í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. Graph Neural Network(GN)ì˜ <code>node update function</code>ì„ ê°€ì§€ê³  bodyì˜ dynamicsì— ëŒ€í•œ í•™ìŠµì„ í•  ìˆ˜ ìˆê³ , <code>edge update function</code>ì„ ê°€ì§€ê³  interactionì˜ dynamicsë¥¼ ì¸ì½”ë”©í•  ìˆ˜ ìˆìœ¼ë©°, <code>global update function</code>ì„ ê°€ì§€ê³  global systemì˜ ì†ì„±ë“¤ì„ ì¸ì½”ë”© í•  ìˆ˜ ìˆë‹¤ê³  ì£¼ì¥í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ë‹¤ë¥¸ ë…¼ë¬¸ë“¤ê³¼ ë‹¤ë¥´ê²Œ íŠ¹ì´í•œ ì ì€ globalí•œ ì‹œìŠ¤í…œì˜ ì†ì„±ì´ë¼ëŠ” ë¶€ë¶„ì„ ë”°ë¡œ ê³ ë ¤ë¥¼ í–ˆë‹¤ëŠ” ì ì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ë…¼ë¬¸ì˜ contributionì€ í¬ê²Œ 3ê°€ì§€ forward model, inference model, control algorithm ì…ë‹ˆë‹¤. (í•˜ì§€ë§Œ ë¦¬ë·°í•˜ë©´ì„œ ëŠë‚€ ì ì€ <em>control algorithm</em> ë¶€ë¶„ì€ contributionì´ë¼ê³  í•˜ê¸°ë³´ë‹¤ëŠ” GN-based modelì„ ê°€ì§€ê³  control pipelineì„ ì˜ ë¶™ì¸ ê²ƒì´ë¼ê³  ìƒê°ë©ë‹ˆë‹¤.) ë‹¤ë¥¸ physics engineë“¤ê³¼ ë‹¤ë¥´ê²Œ ë¬¼ë¦¬ë²•ì¹™ì— ëŒ€í•œ ì‚¬ì „ ì§€ì‹(prior knowledge)ì„ ì „í˜€ ê°€ì •í•˜ì§€ ì•Šì§€ë§Œ ëŒ€ì‹  <code>object- and relation-centric inductive bias</code>ë¥¼ ì´ìš©í•˜ì—¬ <strong>current-state/next-state pairs</strong>ì— ëŒ€í•œ í•™ìŠµì„ í•©ë‹ˆë‹¤. ê·¸ë˜í”„ ê¸°ë°˜ìœ¼ë¡œ ë¬¼ë¦¬ ì‹œìŠ¤í…œì„ forward modelê³¼ inference modelì´ í•™ìŠµí•˜ê²Œ ë˜ë©´ control algorithmì€ ì´ ëª¨ë¸ë“¤ì„ ì´ìš©í•˜ì—¬ planningì´ë‚˜ policy learningì„ í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GN-based forward models</td>
<td>ì •í™•í•˜ê³  ì¼ë°˜í™”ëœ predictionì„ í•  ìˆ˜ ìˆìŒ</td>
</tr>
<tr class="even">
<td>GN-based inference models</td>
<td>observationì— ìˆ¨ê²¨ì ¸ ìˆëŠ” ì†ì„±ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ system identificationì„ í•  ìˆ˜ ìˆìŒ</td>
</tr>
<tr class="odd">
<td>NOT GN-based control algorithms</td>
<td>ë‹¤ë¥¸ ë² ì´ìŠ¤ë¼ì¸ë“¤ë³´ë‹¤ ì¢‹ì€ control í¼í¬ë¨¼ìŠ¤ë¥¼ ë³´ì—¬ì¤Œ</td>
</tr>
</tbody>
</table>
</section>
<section id="model" class="level1">
<h1>2. Model</h1>
<section id="graph-representation-of-a-physical-system" class="level2">
<h2 class="anchored" data-anchor-id="graph-representation-of-a-physical-system">Graph representation of a physical system</h2>
<p>ë¬¼ë¦¬ì‹œìŠ¤í…œì„ ì–´ë–»ê²Œ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ”ì§€ ëª‡ê°€ì§€ ìš©ì–´ì™€ ìˆ˜ì‹ë“¤ì„ ì •ë¦¬í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<ul>
<li>ë¬¼ë¦¬ ì‹œìŠ¤í…œì˜ bodyëŠ” ê·¸ë˜í”„ì˜ <code>node</code>ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.</li>
<li>ë¬¼ë¦¬ ì‹œìŠ¤í…œì˜ jointëŠ” ê·¸ë˜í”„ì˜ <code>edge</code>ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.</li>
<li>ë¬¼ë¦¬ ì‹œìŠ¤í…œì˜ globalí•œ ì†ì„±ì€ <code>global feature</code>ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.</li>
</ul>
<p>ì•„ë˜ ì‚¬ì§„ì—ì„œ ë³´ì´ëŠ” half-cheetahì—ì„œ ì§ê´€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ê·¸ë˜í”„ê°€ ê·¸ë ¤ì§ˆ ìˆ˜ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆê³  ì´ ê·¸ë˜í”„ë¥¼ <span class="math inline">G</span>ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/yN3GlTK.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<p>ì•ì„œ ì„¤ëª…í•œ ë¶€ë¶„ì„ ìˆ˜ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<p><span class="math display">
G=\left(\mathbf{g},\left\{\mathbf{n}_{i}\right\}_{i=1 \cdots N_{n}},\left\{\mathbf{e}_{j}, s_{j}, r_{j}\right\}_{j=1 \cdots N_{e}}\right)
</span></p>
<ul>
<li><span class="math inline">g</span> : global features ì‹œìŠ¤í…œì˜ ì¤‘ë ¥ì´ë‚˜ time stepê³¼ ê°™ì€ ì†ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ë²¡í„°ì…ë‹ˆë‹¤.</li>
<li><span class="math inline">\mathbf{n}_{i}</span> : node featuresë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë²¡í„°ì…ë‹ˆë‹¤.</li>
<li><span class="math inline">\mathbf{e}_{j}</span> : edge featuresë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë²¡í„°ì…ë‹ˆë‹¤.</li>
<li><span class="math inline">s_{j}</span> : ì´ edgeë¥¼ í†µí•´ì„œ messageë¥¼ ë³´ë‚´ëŠ” sender nodesì˜ ì¸ë±ìŠ¤ì…ë‹ˆë‹¤.</li>
<li><span class="math inline">r_{j}</span> : ì´ edgeë¥¼ í†µí•´ì„œ messageë¥¼ ë°›ëŠ” receiver nodesì˜ ì¸ë±ìŠ¤ì…ë‹ˆë‹¤.</li>
</ul>
</section>
<section id="static-dynamic-properties" class="level2">
<h2 class="anchored" data-anchor-id="static-dynamic-properties">Static &amp; Dynamic properties</h2>
<p>ì—¬ê¸°ì„œ static graph <span class="math inline">G_s</span>ì™€ dynamic graph <span class="math inline">G_d</span> ë¼ëŠ” ê·¸ë˜í”„ëŠ” 2ê°€ì§€ ì¢…ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤. ì´ 2ê°œì˜ ê·¸ë˜í”„ëŠ” ê°ê° ì‹œìŠ¤í…œì˜ ì†ì„±ì´ ì‹œê°„ì— ë”°ë¼ ë³€í™”í•˜ëŠ”ì§€(dynamic/time-variant) ì•ˆí•˜ëŠ”ì§€(static/time-invaritant)ì— ë”°ë¼ ê·¸ë˜í”„ë¥¼ êµ¬ì„±í•˜ëŠ” ì •ë³´ì˜ ì¢…ë¥˜ê°€ ë‹¤ë¦…ë‹ˆë‹¤.(ìì„¸í•œ ì •ë³´ëŠ” Appendix G sectionì—ì„œ Mujoco ê¸°ë°˜ì˜ ì–´ë–¤ ì •ë³´ë¡œ ê° ê·¸ë˜í”„ë¥¼ êµ¬ì„±í–ˆëŠ”ì§€ ë‚˜ì™€ìˆìŠµë‹ˆë‹¤.)</p>
<ul>
<li>A static graph <span class="math inline">G_s</span>: ì‹œìŠ¤í…œì˜ staticí•œ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê·¸ë˜í”„
<ul>
<li><code>global parameters</code>: the time step, viscosity, gravity, etc</li>
<li><code>body/node parameters</code>: mass, inertia tensor, etc.</li>
<li><code>joint/edge parameters</code>: joint typeê³¼ properties, motor type and properties, etc</li>
</ul></li>
<li>A dynamic graph <span class="math inline">G_d</span>: ì‹œìŠ¤í…œì˜ ì¼ì‹œì ì¸ state ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê·¸ë˜í”„
<ul>
<li><code>body/node</code>: 3D Cartesian position, 4D quaternion orientation, 3D linear velocity, 3D angular velocity</li>
<li><code>joint/edge</code>: jointì— ì ìš©ëœ actionë“¤ì˜ í¬ê¸°</li>
</ul></li>
</ul>
</section>
<section id="graph-networks" class="level2">
<h2 class="anchored" data-anchor-id="graph-networks">Graph networks</h2>
<ul>
<li><code>graph2graph</code> ëª¨ë“ˆì„ í™œìš©í•˜ì—¬ ì¸í’‹ì„ ê·¸ë˜í”„ë¡œ ë°›ê³  ì•„ì›ƒí’‹ë„ ê·¸ë˜í”„ë¡œ ë°›ëŠ” ëª¨ë¸ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì•„ì›ƒí’‹ì˜ ê·¸ë˜í”„ëŠ” ì¸í’‹ ê·¸ë˜í”„ì™€ ë‹¤ë¥¸ edge, node, global featuresë¥¼ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.</li>
</ul>
<p>ë³¸ ë…¼ë¬¸ì˜ í•µì‹¬ ì•„ì´ë””ì–´ì¸ GN ë¸”ë¡ì˜ êµ¬ì¡°ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. - A core GN block</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/3PffG3H.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<pre><code>- 3ê°œì˜ sub function, MLPë¡œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.
    - edge-wise $f_e$ : ëª¨ë“  edgeë“¤ì— ëŒ€í•œ updateë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.
    - node-wise $f_n$ : ëª¨ë“  nodeë“¤ì— ëŒ€í•œ updateë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.
    - global $f_g$ : ë§ˆì§€ë§‰ìœ¼ë¡œ global featureë“¤ì„ update í•©ë‹ˆë‹¤.</code></pre>
<p>í•˜ë‚˜ì˜ feedforward GN passëŠ” ê·¸ë˜í”„ ìƒì—ì„œ message-passing ë‹¨ê³„ì˜ í•œ ìŠ¤í…ìœ¼ë¡œ ê°„ì£¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ GN-block ë‚´ì—ì„œì˜ ì•Œê³ ë¦¬ì¦˜ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/TjghKvm.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
</section>
<section id="forward-models" class="level2">
<h2 class="anchored" data-anchor-id="forward-models">Forward models</h2>
<p>Forward modelì˜ ëª©ì ì€ <strong>í˜„ì¬ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ìŒ stepì˜ ìƒíƒœë¥¼ ì˜ˆì¸¡(prediction)í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</strong> (ì´ëŠ” ì˜ì–´ ë‹¨ì–´ì˜ ë¹„ìŠ·í•œ ì˜ë¯¸ë•Œë¬¸ì— ë‹¤ìŒì— ë‚˜ì˜¤ëŠ” inference modelì˜ ëª©ì ê³¼ ë§ì´ í˜¼ë™ë  ìˆ˜ ìˆìœ¼ë‹ˆ ì˜ ì •ì˜í•˜ê³  ë„˜ì–´ê°€ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.) forward modelì€ <em>RNN(GRU)ë¥¼ ë„ì…í–ˆëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¼</em> 2ê°€ì§€ íƒ€ì…ì´ ìˆìŠµë‹ˆë‹¤.</p>
<p><strong>Type1. GNN feed-forward</strong></p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/2tN81Kd.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<p>ê°€ì¥ ê°„ë‹¨í•œ GNN feed-forward ëª¨ë¸ì…ë‹ˆë‹¤. ê·¸ë˜í”„ëŠ” ì²˜ìŒì— <span class="math inline">GN_1</span>ì„ ê±°ì³ latent graphì¸ <span class="math inline">G'</span>ì´ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë‹¤ìŒ <span class="math inline">GN_2</span>ì˜ ì¸í’‹ìœ¼ë¡œëŠ” <span class="math inline">GN_1</span>ì„ ê±°ì¹˜ê¸´ ì „ì˜ ê·¸ë˜í”„ì˜€ë˜ <span class="math inline">G</span>ì™€ <span class="math inline">G'</span>ë¥¼ concatenateë¥¼ í•´ì„œ ë„£ì–´ì£¼ê²Œ ë©ë‹ˆë‹¤. ì €ìë“¤ì€ ì´ë ‡ê²Œ ë””ìì¸í•œ ì´ìœ ë¡œ, ê·¸ë˜í”„ì˜ ëª¨ë“  ë…¸ë“œë“¤ê³¼ ì—£ì§€ë“¤ì´ ëª¨ë‘ communicateí•˜ê²Œ í•˜ê¸° ìœ„í•¨ì´ë¼ê³  ì´ì•¼ê¸°í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ <span class="math inline">GN_1</span>, <span class="math inline">GN_2</span>ë¥¼ ê±°ì³ ìµœì¢…ì ìœ¼ë¡œ ë‚˜ì˜¤ëŠ” <span class="math inline">G^*</span>ì˜ node featureë“¤ì´ ê° bodyì˜ ìƒíƒœ prediction ê°’ì´ ë˜ëŠ” ê²ƒ ì…ë‹ˆë‹¤.</p>
<p><strong>Type2. RNN+GNN</strong></p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/7ZKlooE.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<p>ë‹¤ìŒìœ¼ë¡œ ì•ì„œ ê¸°ë³¸ì´ ë˜ëŠ” ëª¨ë¸ì— G-GRUë¥¼ ì¶”ê°€í•œ íƒ€ì…ë‹ˆë‹¤. Type 1ê³¼ ë¹„ìŠ·í•˜ê²Œ skip connection, latent graphë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ”ë° GN blockì˜ GRU ë²„ì ¼ì¸ G-GRUê°€ ë“¤ì–´ê°€ë©´ì„œ <span class="math inline">G_h</span>ë¼ëŠ” RNNì—ì„œ hidden vectorì™€ ê°™ì€ ê°œë…ì˜ hidden graphê°€ ì¶”ê°€ëœ ê²ƒì…ë‹ˆë‹¤. ëª¨ë“  edge, node, global featureë“¤ì— ëŒ€í•´ ê°ê° RNNì´ ì ìš©ë˜ì–´ ì´ 3ê°œì˜ RNN sub-modulesì´ ìˆìŠµë‹ˆë‹¤.</p>
<p><strong>ë‘ê°€ì§€ íƒ€ì…ì˜ GNN forward ëª¨ë¸ì— ê³µí†µì ì¸ ì‚¬í•­</strong></p>
<ol type="1">
<li><p><code>state differences</code>ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì„ í•™ìŠµí•´ì„œ state predictionì˜ ì ˆëŒ“ê°’(absolute)ì„ ê³„ì‚°í•©ë‹ˆë‹¤. ì´ ê³„ì‚°ëœ absolute state predictionì„ ê°€ì§€ê³  stateë¥¼ updateí•˜ê²Œ ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p></li>
<li><p><code>long-range rollout</code> trajectoryë¥¼ ë§Œë“¤ì–´ë‚´ê¸° ìœ„í•´ì„œ state prediction ê°’ê³¼ control inputì„ ë°˜ë³µì ìœ¼ë¡œ modelì— ë„£ì–´ì£¼ì–´ì„œ ì—¬ëŸ¬ ìŠ¤í…ì˜ trajectoryë¥¼ ìƒì„±í•˜ê²Œ ë©ë‹ˆë‹¤.</p></li>
<li><p>GN modelì˜ ì¸í’‹ê³¼ ì•„ì›ƒí’‹ë“¤ì€ normalize ë©ë‹ˆë‹¤.</p></li>
</ol>
<p>ì‚¬ì‹¤ ë¦¬ë·°ë¥¼ í•˜ë©´ì„œ forward modelê³¼ inference model ì‚¬ì´ì˜ êµ¬ë¶„ì´ë‚˜ ëª¨ë¸ì˜ êµ¬ì²´ì ì¸ í”„ë¡œì„¸ìŠ¤ ì´í•´ê°€ pseudo algorithmì„ ë³´ê¸° ì „ê¹Œì§€ ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. Appendixì— ë‚˜ì™€ìˆì–´ì„œ ì˜ ë³´ì§€ ì•Šì„ í™•ë¥ ì´ ë†’ì§€ë§Œ ë…¼ë¬¸ì˜ ê°œë…ì„ ëŒ€ëµì ìœ¼ë¡œ ì´í•´í•˜ê³  ë‚œ í›„ì—ëŠ” ê¼­ line by lineìœ¼ë¡œ ë³´ì‹œê¸¸ ì¶”ì²œí•©ë‹ˆë‹¤.</p>
<p>ë¨¼ì € <strong>forward modelì˜ í•™ìŠµê³¼ì •</strong>ì„ ë³´ì—¬ì£¼ëŠ” pseudo algorithm ì…ë‹ˆë‹¤. ë‹¤ì‹œí•œë²ˆ ì´ ëª¨ë¸ì˜ ëª©ì ì„ ìƒê¸°ì‹œì¼œë³´ìë©´, í˜„ì¬ ìƒíƒœ <span class="math inline">x^{t_0}</span> ë¥¼ ê¸°ë°˜ìœ¼ë¡œ <span class="math inline">a^{t_0}</span>ì™€ í•¨ê»˜ ì£¼ì–´ì¡Œì„ ë•Œ, <span class="math inline">x^{t_0+1}</span>ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì•ì„œ ì„¤ëª…í•œ ë¶€ë¶„ë“¤ì¸, stateì˜ ì”ì°¨ë¥¼ í•™ìŠµí•˜ëŠ” ë¶€ë¶„ì´ë‚˜ normalization ë“±ì´ ì•Œê³ ë¦¬ì¦˜ë‚´ì— ì˜ ë‚˜ì™€ìˆìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/Fzex7GV.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<p>ë‹¤ìŒì€ <strong>í•™ìŠµëœ forward model</strong>ì„ ê°€ì§€ê³  ë‹¤ìŒ ìƒíƒœì¸ <span class="math inline">x^{t_0+1}</span>ì„ ì–´ë–»ê²Œ ì˜ˆì¸¡í•˜ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/ztG7ZuO.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ë°”ë¡œ ìœ„ ì•Œê³ ë¦¬ì¦˜ê³¼ ë™ì¼í•˜ê²Œ <strong>í•™ìŠµëœ forward model</strong>ì„ ê°€ì§€ê³  ë‹¤ìŒ ìƒíƒœì¸ <span class="math inline">x^{t_0+1}</span>ì„ ì–´ë–»ê²Œ ì˜ˆì¸¡í•˜ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ì§€ë§Œ inference modelì—ì„œ í•™ìŠµëœ <span class="math inline">GN_p</span>ë¥¼ ê°€ì§€ê³  <code>system identification</code>ì´ ì¶”ê°€ëœ ìƒíƒœì—ì„œ ì–´ë–»ê²Œ ì•Œê³ ë¦¬ì¦˜ì´ í˜ëŸ¬ê°€ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤.(ì´ì „ì— ì•Œê³ ë¦¬ì¦˜ì—ì„œëŠ” system parameter <span class="math inline">p</span>ë¼ê³  í‘œì‹œë˜ì—ˆë˜ ë¶€ë¶„ì´ ëŒ€ì²´ëœ ê²ƒì…ë‹ˆë‹¤.)</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/Snfkuwb.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
</section>
<section id="inference-models" class="level2">
<h2 class="anchored" data-anchor-id="inference-models">Inference Models</h2>
<p>Inference modelì˜ ëª©ì ì„ í•œ ë§ˆë””ë¡œ í‘œí˜„í•˜ìë©´ <code>System identification</code>ì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. System identificationì´ë€ <strong>ê´€ì°°í•  ìˆ˜ ì—†ëŠ”(unobserved) dynamic systemì˜ ì†ì„±ë“¤ì„ ê´€ì°°ë˜ëŠ”(observed) behavior(ë˜ëŠ” ì–´ë–¤ ì–‘ìƒ)ë¥¼ ê°€ì§€ê³  ì¶”ë¡ í•˜ëŠ” ê²ƒ</strong>ì„ ë§í•©ë‹ˆë‹¤. ì¦‰ ì•”ì‹œì ìœ¼ë¡œ systemì„ êµ¬ì„±í•˜ëŠ” ìš”ì†Œë“¤ì„ (ëª…ì‹œì ì´ì§€ ì•Šì•„) ì¸¡ì •í•˜ê±°ë‚˜ ê´€ì°°í•  ìˆ˜ ì—†ì§€ë§Œ <strong>latent representations</strong>ì„ í†µí•´ ì¶”ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/4ZMFGU1.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<p>Inference modelë„ <strong>Recurrent GN-based model</strong> ì…ë‹ˆë‹¤. forward ëª¨ë¸ê³¼ ë‹¤ë¥¸ ì ìœ¼ë¡œëŠ” ì˜¤ì§ trajectoryì˜ <code>dynamic states</code>ë“¤ë§Œ inputìœ¼ë¡œ ë°›ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ dynamic state graphì¸ <span class="math inline">G_d</span>ì™€ control inputì„ ë°›ìŠµë‹ˆë‹¤. ì•„ì›ƒí’‹ìœ¼ë¡œëŠ” ì¼ì • time step <span class="math inline">T</span>ì´í›„ì˜ <span class="math inline">G^*(T)</span>ì´ ë˜ë©°, ë³¸ ë…¼ë¬¸ì—ì„œ ì´í›„ ì‹¤í—˜íŒŒíŠ¸ì—ì„œ 20 stepì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</p>
<p><strong>inference model í•™ìŠµê³¼ì •</strong>ì˜ pseudo ì•Œê³ ë¦¬ì¦˜ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/0FeskwM.png" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
</section>
<section id="control-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="control-algorithm">Control algorithm</h2>
<p>control algorithmì—ì„œëŠ” ê·¸ë˜í”„ ê¸°ë°˜ì´ ì•„ë‹ˆê³  ì•ì„œ ì„¤ëª…í•œ ê·¸ë˜í”„ ê¸°ë°˜ì˜ forward modelê³¼ inference modelì„ ì˜ í™œìš©í•´ì„œ ì–´ë–»ê²Œ controlí•  ìˆ˜ ìˆì„ì§€ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” í¬ê²Œ 2ê°€ì§€ control algorithmì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ê°•í™”í•™ìŠµì„ ì£¼ë¡œ ì—°êµ¬í•˜ëŠ” ì…ì¥ì—ì„œ ë¦¬ë·°í•´ë³´ë©´, ëŒ€ë¶€ë¶„ ê°•í™”í•™ìŠµì€ model-free ê¸°ë°˜ì˜ ì•Œê³ ë¦¬ì¦˜ì´ ë§ì´ ë°œì „í–ˆëŠ”ë° GNê¸°ë°˜ì˜ ë‹¤ìŒ ìƒíƒœë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆëŠ” modelì„ ë§Œë“¦ìœ¼ë¡œì¨ model-based ê¸°ë°˜ì˜ ê°•í™”í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ ë§¤ìš° í¥ë¯¸ë¡œì› ìŠµë‹ˆë‹¤.</p>
<ol type="1">
<li><p>MPC(Model Predictive Control)</p>
<p>GNì€ ë¯¸ë¶„ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— MPCê°™ì€ <strong>gradient-based trajectory optimization</strong> ë°©ë²•ìœ¼ë¡œ model-based planningì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ MPCê°€ ìˆê³  í•™ìŠµê¸°ë°˜ì´ ì•„ë‹ˆë¼ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì´ë©° ì•Œê³ ë¦¬ì¦˜ì˜ íë¦„ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/4s443v3.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div></li>
<li><p><a href="https://proceedings.neurips.cc/paper/2015/hash/148510031349642de5ca0c544f31b2ef-Abstract.html">SVG</a>(Stochastic Value Gradients)</p>
<p>ê°•í™”í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜ì´ë©°, GN-based modelê³¼ SVGì˜ policy functionì„ ë™ì‹œì— í•™ìŠµí•˜ëŠ” agentë¡œ controlì„ í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. SVG(1)ì€ í•œ ìŠ¤í…ì„ ì˜ˆì¸¡í•˜ëŠ” GN modelì„ ê°€ì§€ê³  ê°•í™”í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ controlì„ í•œ ê²ƒì´ë©°(model-based) SVG(0)ì€ ì˜ˆì¸¡í•˜ëŠ” GN model ì—†ì´ model-free ê¸°ë°˜ìœ¼ë¡œ controlí•œ ê²ƒìœ¼ë¡œ ì´í•´í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p></li>
</ol>
<blockquote class="blockquote">
<p>ì‚¬ì‹¤ MPCì™€ SVGëŠ” ë§¤ìš° ë¹„ìŠ·í•œ ì¸¡ë©´ì´ ìˆìŠµë‹ˆë‹¤. MPCì—ì„œëŠ” control inputsë“¤ì´ í•œ ì—í”¼ì†Œë“œì—ì„œ ì´ˆê¸° ì¡°ê±´ë“¤ì´ ì£¼ì–´ì¡Œì„ ë•Œ ìµœì í™” ë˜ëŠ” ê²ƒì´ë¼ë©´, SVGì—ì„œëŠ” stateì™€ controlì„ ë§¤ì¹­ì‹œí‚¤ëŠ” policy functionì´ í•™ìŠµê³¼ì •ì—ì„œ ê²½í—˜í•œ statesì— ëŒ€í•´ì„œ ìµœì í™” ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
</blockquote>
</section>
</section>
<section id="methods" class="level1">
<h1>3. Methods</h1>
<p><span style="color: blue">Environments</span></p>
<ul>
<li>MuJoCo ì‹œë®¬ë ˆì´ì…˜ í™˜ê²½ì„ ì´ìš©í–ˆë‹¤.
<ul>
<li>Pendulum, Cartpole, Acrobot, Swimmer, Cheetah, Walker2d, JACO(robotic arm)</li>
</ul></li>
<li>generated training data for our forward models by applying simulated random controls to the systems, and recording the state transitions</li>
<li>generalization and system identification ì‹¤í—˜ì„ ìœ„í•´ì„œ
<ul>
<li>created a dataset of versions of several of our systemsâ€”Pendulum, Cartpole, Swimmer, Cheetah and JACOâ€” with procedurally varied parameters and structure.</li>
<li>ë³€í™”ì‹œí‚¨ ì†ì„±ë“¤ë¡œëŠ” link lengths, body masses, and motor gears. + varied the number of links in the Swimmerâ€™s structure, from 3-15 (we refer to a swimmer with N links as SwimmerN )</li>
</ul></li>
</ul>
<p><span style="color: blue">MPC planning</span></p>
<ul>
<li><strong>N-step trajectory</strong>(N: planning horizon)ì™€ ê·¸ trajectoryë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ ë°›ì„ <strong>total reward</strong>ë¥¼ GN forward ëª¨ë¸ë¡œ ì˜ˆì¸¡í–ˆë‹¤.</li>
<li>ì´ë•Œì˜ action sequences(=trajectory)ë“¤ì„ total rewardì˜ backpropagating gradientë¥¼ ê°€ì§€ê³  ìµœì í™”í•˜ê²Œ ëœë‹¤.</li>
</ul>
<p>Model-based reinforcement learning</p>
<ul>
<li>GN-based modelì„ ê°•í™”í•™ìŠµì— ì ìš©í•´ë³´ë‹¤</li>
<li>SVGë¥¼ ì´ìš©í–ˆë‹¤.</li>
<li>GN forward modelì´ ë¯¸ë¶„ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— GN ëª¨ë¸ë¡œ ìƒì„±ëœ next stateë¥¼ ê°€ì§€ê³  expected return ê°’ì˜ ê·¸ë¼ë””ì–¸íŠ¸ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.</li>
<li>1 stepì„ ì˜ˆì¸¡í•˜ëŠ” SVG(1)ê³¼</li>
<li>model-free RL ë² ì´ìŠ¤ë¼ì¸ê³¼ ë¹„êµí•˜ê¸° ìœ„í•´ SVG(0)ê³¼ deterministic policy ì•Œê³ ë¦¬ì¦˜ì¸ DDPG(Deep Deterministic Policy Gradients)ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í–ˆë‹¤.</li>
</ul>
<p><span style="color: blue">Baseline comparisons</span></p>
<ol type="1">
<li>constant prediction baseline: input stateë¥¼ ê·¸ëŒ€ë¡œ output stateë¡œ ì‚¬ìš©</li>
<li>MLP baseline: GN modelì— ì“°ì¸ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ MLPì— flattened &amp; concatenated í•´ì„œ í•™ìŠµ</li>
<li>MPC baseline: ë¬¼ë¦¬ ëª¨ë¸ì„ ê°€ì§€ê³  Differential Dynamic Programming algorithmì„ ì‚¬ìš©í•´ì„œ ground truth ê°’ì„ ê°€ì§</li>
<li>SVG(0): model-free RL agents</li>
<li>DDPG: model-free RL agents</li>
</ol>
<p>Prediction performance evaluation</p>
<ul>
<li>calculated independent errors for <strong>position, orientation, linear velocity angular velocity</strong></li>
</ul>
<ol type="1">
<li>squared one-step dynamic state differences (one-step error)</li>
<li>squared trajectory differences (rollout error) between the prediction and the ground truth.</li>
</ol>
</section>
<section id="results" class="level1">
<h1>4. Results</h1>
<section id="prediction" class="level2">
<h2 class="anchored" data-anchor-id="prediction">Prediction</h2>
<p><span style="color: blue">Learning a <strong>forward</strong> model for a <strong>single</strong> system</span></p>
<p>í•˜ë‚˜ì˜ ì‹œìŠ¤í…œì„ ê°€ì§€ê³  í•™ìŠµí•œ forward modelì˜ Prediction ì„±ëŠ¥ ì‚´í´ë³´ê¸°</p>
<ul>
<li><p>random controlë¡œ ë§Œë“¤ì–´ì§„ ë°ì´í„°ë“¤ì„ ê°€ì§€ê³  í•™ìŠµëœ GN-based model</p>
<ul>
<li><p><strong>[Visually]</strong> Swimmer6ì—ì„œ ê·¸ë¦¼ì—ì„œ ì²˜ëŸ¼ ground truthì™€ ì˜ˆì¸¡ ê²°ê³¼ê°€ êµ¬ë¶„ì´ ì•ˆ ê°ˆ ì •ë„ë¡œ í¡ì‚¬í•˜ë‹¤.(<a href="https://drive.google.com/file/d/1ez6sqCTZmHdSnf86lK6NEsnzyi-O25-B/view">ì˜ìƒ</a>ì—ì„œë„ ê±°ì˜ êµ¬ë¶„ì´ ì•ˆ ê°ˆ ì •ë„ë¡œ ì˜ ì˜ˆì¸¡í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.)</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/N6bOymB.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div></li>
<li><p><strong>[Quantitatively]</strong> 100 stepì—ì„œ 3ì¶• ë°©í–¥ìœ¼ë¡œì˜ ìœ„ì¹˜, ì„ ì†ë„, ê°ì†ë„, ì¿¼í„°ë‹ˆì•ˆ ë°©í–¥ ë¹„êµ</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/anOJrxE.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div></li>
</ul></li>
<li><p>constant prediction baselineì€ ì•„ì›ƒí’‹ìœ¼ë¡œ ì¸í’‹ì„ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ì„œ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— ì• ëŸ¬ ìµœëŒ€ì¹˜ë¡œ normalization í•˜ê¸° ìœ„í•´ ê²€ì€ìƒ‰ ì ì„ ìœ¼ë¡œ í‘œê¸°</p></li>
<li><p>ìš°ì„  ê²€ì€ ì ì„ ê³¼ ë§‰ëŒ€ê¸°ë“¤ì„ ë­‰ëš±ê·¸ë ¤ì„œ ë³´ë©´,</p></li>
<li><p>1 stepê³¼ 100 stepì˜ rollout ê²°ê³¼ë¥¼ ë¹„êµí–ˆì„ ë•Œ ê²€ì€ ì ì„ ì— ë¹„í•´ íŒŒë€ìƒ‰ ë§‰ëŒ€ê¸°ë“¤ì˜ error ê°’ì´ ë‚®ìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/atKJKme.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div></li>
<li><p>GN ëª¨ë¸ì´ MLP-based ë³´ë‹¤ ë” ë‚®ì€ ì• ëŸ¬ë¥¼ ê°€ì§€ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ëŠ” íŠ¹ë³„íˆ Swimmer6ì²˜ëŸ¼ ì—ì´ì „íŠ¸ì˜ êµ¬ì¡°ê°€ ë°˜ë³µì ì¸ ê²½ìš°ì— ë”ìš± ëˆˆì— ë„ê²Œ ë‚®ìŒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. ì´ë¥¼ í†µí•´ GN-based forward ëª¨ë¸ì´ ë‹¤ì–‘í•œ ë¬¼ë¦¬ ì‹œìŠ¤í…œë“¤ì—ì„œ dynamicsë¥¼ ì˜ ì˜ˆì¸¡í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.</p></li>
</ul>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/u7z0wJP.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<ul>
<li>GNì´ MLPë³´ë‹¤ ë” generalizationì´ ì˜ ë¨ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆëŠ”ë°, Swimmer6ë¥¼ ì§‘ì¤‘ì ìœ¼ë¡œ <code>train</code>, <code>valid</code>, <code>test</code> ë°ì´í„°ì— ëŒ€í•´ 1-step, rollout errorë¥¼ ê°ê° í™•ì¸í•´ë´¤ì„ ë•Œ, Best GNì˜ error ê°’ì´ Best MLPë³´ë‹¤ ë‚®ìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ test dataì˜ error ì¦ê°€ìœ¨ì„ ë´¤ì„ ë•Œì—ë„ GN ëª¨ë¸ì˜ test dataì˜ errorê°€ ë” ì ê²Œ ì¦ê°€í•¨ì„ ê´€ì°°í•  ìˆ˜ ìˆì—ˆê³  ì´ëŠ” agentì˜ bodiesì™€ jointsë“¤ì— ëŒ€í•œ inductive biasê°€ GNì„ í†µí•´ ì˜ í•™ìŠµë˜ì—ˆìŒì„ ì¦ëª…í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/bMJJ6Jb.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
<p>Learning a forward model for <strong>multiple</strong> systems</p>
<p>í•œ ê°œì˜ ì‹œìŠ¤í…œì—ì„œì˜ forward modelì„ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ ì´ì œ ì—¬ëŸ¬ ì‹œìŠ¤í…œì—ì„œì˜ forward modelì˜ ì„±ëŠ¥ì„ ì‚´í´ë³´ì. GNì„ ì‚¬ìš©í•˜ë©´ ì—¬ëŸ¬ ì‹œìŠ¤í…œë“¤ì˜ ë‹¤ì–‘í•œ ë³€ìˆ˜ë“¤ë„ ì˜ ë‹¤ë£° ìˆ˜ ìˆë‹¤ëŠ” ê°€ì •ì´ ìˆì—ˆë‹¤. ì´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì—°ì†ì ìœ¼ë¡œ static parameterë“¤(ì§ˆëŸ‰, bodyì˜ ê¸¸ì´, jointì˜ ê°ë„ ë“±)ì„ ë°”ê¿”ê°€ë©´ì„œ forward dynamicsë¥¼ ì–´ë–»ê²Œ í•™ìŠµí•´ê°€ëŠ”ì§€ í™•ì¸í–ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-default">
<figure class="figure">
<p><img src="https://i.imgur.com/pM4UKhs.png?1" class="img-fluid quarto-figure quarto-figure-default figure-img"></p>
</figure>
</div>
</section>
<section id="inference" class="level2">
<h2 class="anchored" data-anchor-id="inference">Inference</h2>
</section>
<section id="control" class="level2">
<h2 class="anchored" data-anchor-id="control">Control</h2>
</section>
</section>
<section id="discussion" class="level1">
<h1>5. Discussion</h1>
<p><strong>Review</strong></p>
<blockquote class="blockquote">
<p>ë…¼ë¬¸ ë¦¬ë·°í›„ì˜ ì£¼ê´€ì ì¸ ì¥ë‹¨ì ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
</blockquote>
<ul>
<li>Pros ğŸ‘
<ul>
<li></li>
</ul></li>
<li>Cons ğŸ‘
<ul>
<li>mlp comparison</li>
</ul></li>
</ul>
<hr>
<p><strong>Reference</strong></p>
<ul>
<li>Original paper <a href="https://arxiv.org/abs/1806.01242">Graph Networks as Learnable Physics Engines for Inference and Control</a></li>
<li>Official code <a href="https://github.com/fxia22/gn.pytorch">https://github.com/fxia22/gn.pytorch</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="curieuxjy/blog_comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Jung Yeon Lee</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/curieuxjy">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>