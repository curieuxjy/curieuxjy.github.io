---
title: "ğŸ“ƒGN-Block(2)"
description: Graph Networks as Learnable Physics Engines for Inference and Control
date: "2022-08-14"
categories: [gnn, mpc, gn-block, system identification, deepmind, paper review]
toc: true
---

ì´ë²ˆ postëŠ” [Graph Networks as Learnable Physics Engines for Inference and Control](https://arxiv.org/abs/1806.01242) ë¼ëŠ” ë…¼ë¬¸ì„ ì½ê³  ë¦¬ë·°í•œ ë‚´ìš©ì´ë©°, ì´ 2ê°œì˜ postë¡œ ì •ë¦¬ë˜ì–´ ìˆì–´ì„œ ì´ë²ˆì—ëŠ” ë…¼ë¬¸ì˜ Method ~ Discussion ê¹Œì§€ì— ëŒ€í•œ ë‚´ìš©ì´ ì •ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

- [GN-Block(1) post](https://curieuxjy.github.io/blog/gnn/mpc/gn-block/system%20identification/deepmind/paper%20review/2022/08/07/gn-block-1.html)
- [GN-Block(2) post](https://curieuxjy.github.io/blog/gnn/mpc/gn-block/system%20identification/deepmind/paper%20review/2022/08/14/gn-block-2.html)


# 3. Methods

<span style="color: blue">Environments</span>

- MuJoCo ì‹œë®¬ë ˆì´ì…˜ í™˜ê²½ì„ ì´ìš©í–ˆë‹¤.
    - Pendulum, Cartpole, Acrobot, Swimmer, Cheetah, Walker2d, JACO(robotic arm)
- generated training data for our forward models by applying simulated random controls to the systems, and recording the state transitions
- generalization and system identification ì‹¤í—˜ì„ ìœ„í•´ì„œ
    - created a dataset of versions of several of our systemsâ€”Pendulum, Cartpole, Swimmer, Cheetah and JACOâ€” with procedurally varied parameters and structure.
    - ë³€í™”ì‹œí‚¨ ì†ì„±ë“¤ë¡œëŠ” link lengths, body masses, and motor gears. + varied the number of links in the Swimmerâ€™s structure, from 3-15 (we refer to a swimmer with N links as SwimmerN )

<span style="color: blue">MPC planning</span>

- **N-step trajectory**(N: planning horizon)ì™€ ê·¸ trajectoryë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ ë°›ì„ **total reward**ë¥¼ GN forward ëª¨ë¸ë¡œ ì˜ˆì¸¡í–ˆë‹¤.
- ì´ë•Œì˜ action sequences(=trajectory)ë“¤ì„ total rewardì˜ backpropagating gradientë¥¼ ê°€ì§€ê³  ìµœì í™”í•˜ê²Œ ëœë‹¤.

Model-based reinforcement learning

- GN-based modelì„ ê°•í™”í•™ìŠµì— ì ìš©í•´ë³´ë‹¤
- SVGë¥¼ ì´ìš©í–ˆë‹¤.
- GN forward modelì´ ë¯¸ë¶„ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— GN ëª¨ë¸ë¡œ ìƒì„±ëœ next stateë¥¼ ê°€ì§€ê³  expected return ê°’ì˜ ê·¸ë¼ë””ì–¸íŠ¸ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.
- 1 stepì„ ì˜ˆì¸¡í•˜ëŠ” SVG(1)ê³¼
- model-free RL ë² ì´ìŠ¤ë¼ì¸ê³¼ ë¹„êµí•˜ê¸° ìœ„í•´ SVG(0)ê³¼ deterministic policy ì•Œê³ ë¦¬ì¦˜ì¸ DDPG(Deep Deterministic Policy Gradients)ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í–ˆë‹¤.

<span style="color: blue">Baseline comparisons</span>

1. constant prediction baseline: input stateë¥¼ ê·¸ëŒ€ë¡œ output stateë¡œ ì‚¬ìš©
2. MLP baseline: GN modelì— ì“°ì¸ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ MLPì— flattened & concatenated í•´ì„œ í•™ìŠµ
3. MPC baseline: ë¬¼ë¦¬ ëª¨ë¸ì„ ê°€ì§€ê³  Differential Dynamic Programming algorithmì„ ì‚¬ìš©í•´ì„œ ground truth ê°’ì„ ê°€ì§
4. SVG(0): model-free RL agents
5. DDPG: model-free RL agents

Prediction performance evaluation

- calculated independent errors for **position, orientation, linear velocity angular velocity**
1. squared one-step dynamic state differences (one-step error)
2. squared trajectory differences (rollout error) between the prediction and the ground truth.

# 4. Results

## Prediction

<span style="color: blue">Learning a **forward** model for a **single** system</span>

í•˜ë‚˜ì˜ ì‹œìŠ¤í…œì„ ê°€ì§€ê³  í•™ìŠµí•œ forward modelì˜ Prediction ì„±ëŠ¥ ì‚´í´ë³´ê¸°

- random controlë¡œ ë§Œë“¤ì–´ì§„ ë°ì´í„°ë“¤ì„ ê°€ì§€ê³  í•™ìŠµëœ GN-based model
    - **[Visually]** Swimmer6ì—ì„œ ê·¸ë¦¼ì—ì„œ ì²˜ëŸ¼ ground truthì™€ ì˜ˆì¸¡ ê²°ê³¼ê°€ êµ¬ë¶„ì´ ì•ˆ ê°ˆ ì •ë„ë¡œ í¡ì‚¬í•˜ë‹¤.([ì˜ìƒ](https://drive.google.com/file/d/1ez6sqCTZmHdSnf86lK6NEsnzyi-O25-B/view)ì—ì„œë„ ê±°ì˜ êµ¬ë¶„ì´ ì•ˆ ê°ˆ ì •ë„ë¡œ ì˜ ì˜ˆì¸¡í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.)
        
        ![](https://i.imgur.com/N6bOymB.png?1)
        
    - **[Quantitatively]** 100 stepì—ì„œ 3ì¶• ë°©í–¥ìœ¼ë¡œì˜ ìœ„ì¹˜, ì„ ì†ë„, ê°ì†ë„, ì¿¼í„°ë‹ˆì•ˆ ë°©í–¥ ë¹„êµ
        
        ![](https://i.imgur.com/anOJrxE.png?1)
        
- constant prediction baselineì€ ì•„ì›ƒí’‹ìœ¼ë¡œ ì¸í’‹ì„ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ì„œ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— ì• ëŸ¬ ìµœëŒ€ì¹˜ë¡œ normalization í•˜ê¸° ìœ„í•´ ê²€ì€ìƒ‰ ì ì„ ìœ¼ë¡œ í‘œê¸°
- ìš°ì„  ê²€ì€ ì ì„ ê³¼ ë§‰ëŒ€ê¸°ë“¤ì„ ë­‰ëš±ê·¸ë ¤ì„œ ë³´ë©´,
- 1 stepê³¼ 100 stepì˜ rollout ê²°ê³¼ë¥¼ ë¹„êµí–ˆì„ ë•Œ ê²€ì€ ì ì„ ì— ë¹„í•´ íŒŒë€ìƒ‰ ë§‰ëŒ€ê¸°ë“¤ì˜ error ê°’ì´ ë‚®ìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    
    ![](https://i.imgur.com/atKJKme.png?1)
    

- GN ëª¨ë¸ì´ MLP-based ë³´ë‹¤ ë” ë‚®ì€ ì• ëŸ¬ë¥¼ ê°€ì§€ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ëŠ” íŠ¹ë³„íˆ Swimmer6ì²˜ëŸ¼ ì—ì´ì „íŠ¸ì˜ êµ¬ì¡°ê°€ ë°˜ë³µì ì¸ ê²½ìš°ì— ë”ìš± ëˆˆì— ë„ê²Œ ë‚®ìŒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. ì´ë¥¼ í†µí•´ GN-based forward ëª¨ë¸ì´ ë‹¤ì–‘í•œ ë¬¼ë¦¬ ì‹œìŠ¤í…œë“¤ì—ì„œ dynamicsë¥¼ ì˜ ì˜ˆì¸¡í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.

![](https://i.imgur.com/u7z0wJP.png?1)

- GNì´ MLPë³´ë‹¤ ë” generalizationì´ ì˜ ë¨ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆëŠ”ë°, Swimmer6ë¥¼ ì§‘ì¤‘ì ìœ¼ë¡œ `train`, `valid`, `test` ë°ì´í„°ì— ëŒ€í•´ 1-step, rollout errorë¥¼ ê°ê° í™•ì¸í•´ë´¤ì„ ë•Œ, Best GNì˜ error ê°’ì´ Best MLPë³´ë‹¤ ë‚®ìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ test dataì˜ error ì¦ê°€ìœ¨ì„ ë´¤ì„ ë•Œì—ë„ GN ëª¨ë¸ì˜ test dataì˜ errorê°€ ë” ì ê²Œ ì¦ê°€í•¨ì„ ê´€ì°°í•  ìˆ˜ ìˆì—ˆê³  ì´ëŠ” agentì˜ bodiesì™€ jointsë“¤ì— ëŒ€í•œ inductive biasê°€ GNì„ í†µí•´ ì˜ í•™ìŠµë˜ì—ˆìŒì„ ì¦ëª…í•  ìˆ˜ ìˆë‹¤.

![](https://i.imgur.com/bMJJ6Jb.png?1)

Learning a forward model for **multiple** systems

í•œ ê°œì˜ ì‹œìŠ¤í…œì—ì„œì˜ forward modelì„ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ ì´ì œ ì—¬ëŸ¬ ì‹œìŠ¤í…œì—ì„œì˜ forward modelì˜ ì„±ëŠ¥ì„ ì‚´í´ë³´ì. GNì„ ì‚¬ìš©í•˜ë©´ ì—¬ëŸ¬ ì‹œìŠ¤í…œë“¤ì˜ ë‹¤ì–‘í•œ ë³€ìˆ˜ë“¤ë„ ì˜ ë‹¤ë£° ìˆ˜ ìˆë‹¤ëŠ” ê°€ì •ì´ ìˆì—ˆë‹¤. ì´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì—°ì†ì ìœ¼ë¡œ static parameterë“¤(ì§ˆëŸ‰, bodyì˜ ê¸¸ì´, jointì˜ ê°ë„ ë“±)ì„ ë°”ê¿”ê°€ë©´ì„œ forward dynamicsë¥¼ ì–´ë–»ê²Œ í•™ìŠµí•´ê°€ëŠ”ì§€ í™•ì¸í–ˆë‹¤.

![](https://i.imgur.com/pM4UKhs.png?1)

## Inference

## Control

# 5. Discussion

**Review**

> ë…¼ë¬¸ ë¦¬ë·°í›„ì˜ ì£¼ê´€ì ì¸ ì¥ë‹¨ì ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

- Pros ğŸ‘
    - 
    
- Cons ğŸ‘
    - mlp comparison

---

**Reference**

- Original paper [Graph Networks as Learnable Physics Engines for Inference and Control](https://arxiv.org/abs/1806.01242)
- Official code [https://github.com/fxia22/gn.pytorch](https://github.com/fxia22/gn.pytorch)