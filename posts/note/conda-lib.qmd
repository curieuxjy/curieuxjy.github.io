---
title: "📝Conda library 경로설정"
toc: true
date: "2025-04-09"
description: 매번 이 문제로 돌아오니까 확실히 정리하자
categories: [linux, conda, cheetsheet, 2025]
format:
  html:
    code-fold: true
    code-summary: "Show the code"
---

# library 경로 설정

> conda env lib 연결시

```{.sh code-line-numbers=false}
$ export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/usr/work/mylib

vi ~/.bashrc (파일명 앞의 .은 숨김파일을 의미)
export LD_LIBRARY_PATH=/home/user/work/mylib:${LD_LIBRARY_PATH}
```

# Reference
- https://stackoverflow.com/questions/73582092/importerror-libpython3-8-so-1-0-cannot-open-shared-object-file-no-such-file-o

---

아래는 지금까지 설명한 내용을 하나의 마크다운 문서로 정리한 것입니다. 각 명령어와 개념, 그리고 Conda 환경 사용 시 주의 사항을 포함하여 작성했습니다.

---

# IsaacGym 에러 해결 및 Conda 환경 관련 설정 정리

IsaacGym 사용 시 발생했던 에러 메시지:

```bash
ImportError: libpython3.8.so.1.0: cannot open shared object file: No such file or directory
```

이 에러는 공유 라이브러리 **libpython3.8.so.1.0**를 찾지 못해서 발생합니다. Conda 환경에서는 이 파일이 Conda 환경의 `lib` 디렉터리에 위치하지만, 시스템의 동적 링커(dynamic linker)가 해당 경로를 기본적으로 인식하지 못하는 경우가 많습니다.

---

## 문제 해결 방법 요약

1. **Conda 환경 활성화**  
   - 올바른 Conda 환경이 활성화되어야 `$CONDA_PREFIX`가 올바르게 정의됩니다.
   - 예:  
     ```bash
     conda activate rws
     ```

2. **라이브러리 파일 존재 여부 확인**  
   - `$CONDA_PREFIX/lib`에서 **libpython3.8.so.1.0** 파일이 실제로 존재하는지 확인합니다.
   - 예:
     ```bash
     find $CONDA_PREFIX/lib -name "libpython3.8.so.1.0"
     ```

3. **LD_LIBRARY_PATH 설정**  
   - Conda 환경의 `lib` 폴더를 동적 라이브러리 검색 경로에 추가하여 라이브러리 로딩 문제를 해결합니다.
   - 예:
     ```bash
     export LD_LIBRARY_PATH=$CONDA_PREFIX/lib:$LD_LIBRARY_PATH
     ```

4. **심볼릭 링크 생성 및 ldconfig 사용**  
   - 시스템 전역 경로에 Conda 환경의 공유 라이브러리에 대한 심볼릭 링크를 만들고, 동적 링커 캐시를 업데이트합니다.
   - 예:
     ```bash
     sudo ln -s $CONDA_PREFIX/lib/libpython3.8.so.1.0 /usr/local/lib/libpython3.8.so.1.0
     sudo ldconfig
     ```

5. **IsaacGym 바인딩 확인**  
   - IsaacGym의 바인딩이 현재 Conda 환경의 Python 버전(여기서는 3.8)에 맞게 빌드되어 있는지 확인합니다.

---

## 명령어 상세 설명 (한국어)

### 1. 심볼릭 링크 생성과 ldconfig

```bash
sudo ln -s $CONDA_PREFIX/lib/libpython3.8.so.1.0 /usr/local/lib/libpython3.8.so.1.0
sudo ldconfig
```

- **sudo**:  
  관리자 권한으로 명령어를 실행합니다. `/usr/local/lib`와 같은 시스템 디렉터리에 접근하기 위함입니다.

- **ln -s**:  
  심볼릭 링크(symbolic link)를 생성합니다.  
  - 원본 파일인 `$CONDA_PREFIX/lib/libpython3.8.so.1.0`에 대한 링크를 `/usr/local/lib`에 생성하여, 시스템 전역에서 해당 라이브러리를 찾을 수 있도록 합니다.

- **sudo ldconfig**:  
  동적 링커 캐시를 업데이트하여 새로 생성된 심볼릭 링크(및 다른 라이브러리 정보)를 시스템에 알립니다.  
  - 이 명령어를 통해 프로그램 실행 시 라이브러리 검색 경로에서 빠르고 정확하게 라이브러리를 찾습니다.

---

### 2. 환경 변수 LD_LIBRARY_PATH 설정

```bash
export LD_LIBRARY_PATH=$CONDA_PREFIX/lib:$LD_LIBRARY_PATH
```

- **export**:  
  현재 셸에서 설정한 환경 변수를 하위 프로세스에 전달할 수 있도록 합니다.

- **LD_LIBRARY_PATH**:  
  동적 라이브러리(.so 파일)를 검색할 경로 목록을 지정하는 환경 변수입니다.  
  - 이 변수에 Conda 환경의 `lib` 디렉터리를 추가하면, 시스템 기본 경로에서 찾지 못할 경우 해당 경로에서 라이브러리를 로드합니다.

- **$CONDA_PREFIX/lib**:  
  현재 활성화된 Conda 환경의 `lib` 디렉터리 경로입니다.

- **:$LD_LIBRARY_PATH**:  
  기존에 설정되어 있던 경로들을 보존하여 새로운 경로와 함께 모두 사용되게 합니다.

---

### 3. Conda 환경과 LD_LIBRARY_PATH

- **여러 Conda 환경을 사용하는 경우**:  
  각 Conda 환경은 고유의 `$CONDA_PREFIX`를 가집니다. 환경을 활성화할 때 해당 환경에 맞는 경로가 설정되도록 해야 합니다.  
  한 셸 세션에서 모든 환경의 경로를 동시에 유지하는 것은 일반적이지 않으며, 환경을 전환할 때마다 적절한 설정이 적용되도록 하는 것이 중요합니다.

- **경로 누적**:  
  위와 같이 명령어를 실행하면 기존의 LD_LIBRARY_PATH 값에 새 경로가 앞부분에 추가됩니다.  
  같은 명령어를 반복 실행하면 경로가 중복되어 쌓일 수 있으므로, 필요할 경우 조건문을 사용해 한 번만 설정하도록 하는 것이 좋습니다.

---

### 4. ~/.bashrc 파일에 추가하는 방법

Conda 환경이 활성화된 상태에서만 올바른 경로가 추가되도록 하려면, 조건문을 사용하여 ~/.bashrc 파일에 아래와 같이 추가할 수 있습니다.

```bash
if [ -n "$CONDA_PREFIX" ]; then
    export LD_LIBRARY_PATH=$CONDA_PREFIX/lib:$LD_LIBRARY_PATH
fi
```

- **조건문**:  
  `$CONDA_PREFIX` 변수가 존재할 때만 환경 변수 설정을 실행합니다.  
  - 만약 Conda 환경이 활성화되지 않은 경우에는 빈 값이므로, 불필요한 경로 설정을 방지할 수 있습니다.
  
- **~/.bashrc 사용**:  
  이 설정을 ~/.bashrc 파일 맨 아래에 추가하면, 새로운 터미널 창을 열 때마다 자동으로 실행됩니다. 단, Conda 환경이 활성화된 후에 적용되도록 Conda의 activate 스크립트가 실행된 이후여야 합니다.

---

## 최종 요약

- **에러 원인**: IsaacGym이 동적 라이브러리 **libpython3.8.so.1.0**를 찾지 못함.  
- **해결 방법**:  
  1. Conda 환경을 활성화하여 올바른 `$CONDA_PREFIX`를 설정  
  2. LD_LIBRARY_PATH에 Conda 환경의 `lib` 경로 추가  
  3. 시스템 전역에서 해당 라이브러리를 인식하도록 심볼릭 링크 생성 후 ldconfig 실행  
- **명령어 설명**:  
  - **심볼릭 링크 생성**: Conda 환경의 라이브러리를 `/usr/local/lib`에 연결.  
  - **ldconfig**: 시스템 캐시를 업데이트하여 라이브러리 검색에 반영.  
  - **환경 변수 설정**: `$CONDA_PREFIX/lib`를 LD_LIBRARY_PATH에 추가하여 하위 프로세스가 해당 경로를 인식하도록 함.  
- **추가 설정**:  
  - ~/.bashrc 파일에 조건문을 통해 환경이 활성화된 경우에만 해당 설정이 적용되도록 할 수 있음.

이와 같이 설정함으로써, 각 Conda 환경에 따른 동적 라이브러리 로딩 문제를 효율적으로 해결할 수 있습니다.

