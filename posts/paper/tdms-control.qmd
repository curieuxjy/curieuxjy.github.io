---
draft: true
title: "ğŸ“ƒA Generalist Dynamics Model for Control"
description: Investigation of the use of transformer sequence models as dynamics models (TDMs) for control
date: "2023-06-11"
categories: [transformer, control, paper]
toc: true
number-sections: true
---



ì´ë²ˆ í¬ìŠ¤íŒ…ì€ DeepMindì—ì„œ ë°œí‘œëœ [A Generalist Dynamics Model for Control](https://arxiv.org/abs/2305.10912) ë…¼ë¬¸ì„ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤. NLP ë¶„ì•¼ì—ì„œ ìœ ëª…í•œ **Transformer ì•„í‚¤í…ì³ê°€ Control ë¶„ì•¼ì—ì„œ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ê³  ê·¸ íš¨ê³¼ê°€ ì–´ë–¤ì§€**ì— ëŒ€í•´ ì¡°ì‚¬í•œ ë…¼ë¬¸ìœ¼ë¡œ ìš”ì¦˜ì²˜ëŸ¼ ê°•ë ¥í•œ ë² ì´ìŠ¤ ëª¨ë¸ì¸ Transformerê°€ ëª¨ë“  ë¶„ì•¼ì— ë»—ì–´ë‚˜ê°€ê³  ìˆëŠ” ì´ë•Œì— Controlì—ì„œëŠ” ì–´ë–¤ ì˜í–¥ë ¥ì„ ê°€ì§€ê³  ì‚¬ìš©ë˜ê³  ìˆëŠ”ì§€ ì•Œì•„ë³´ëŠ”ê²Œ ì •ë§ í¥ë¯¸ë¡œì› ê¸° ë•Œë¬¸ì— ë¦¬ë·°í•´ë³´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.



![](../../images/2023-06-01-tdms-control/tdm1.png)

# Introduction

ë¡œë´‡ ê³µí•™ ì—°êµ¬ì˜ ì¤‘ìš”í•œ ëª©í‘œëŠ” ë³µì¡í•œ í™˜ê²½ì—ì„œ ë‹¤ì–‘í•œ ëª©í‘œë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì—ì´ì „íŠ¸ë¥¼ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤. ì¸ê³µì§€ëŠ¥ì˜ ë°œì „ê³¼ ë”ë¶ˆì–´ ë³µì¡í•œ ì‘ì—…ì— ëŒ€í•´ ìœ ì—°í•˜ê³  ì„±ê³µì ì¸ ë™ì‘ë“¤ì„ ë³´ì—¬ì£¼ì§€ë§Œ, í•™ìŠµì„ ìœ„í•œ ë§ì€ ì–‘ì˜ ë°ì´í„°ê°€ í•„ìš”í•˜ê³  í•œ ê°€ì§€ task ë§Œ ì˜í•˜ëŠ” specialist ì—ì´ì „íŠ¸ê°€ ë©ë‹ˆë‹¤. ë¡œë´‡ ê³µí•™ì—ì„œ í˜„ì¬ì˜ ìµœì²¨ë‹¨ ì ‘ê·¼ë²• ì¤‘ ë§ì€ ë¶€ë¶„ì´ ë¶€ì¡±í•œ íŠ¹ì§•ì€ **ì¼ë°˜ì„±**ì…ë‹ˆë‹¤: ì´ì „ì˜ ê²½í—˜ì„ ë³´ì´ì§€ ì•Šì€ í™˜ê²½ì— ì¼ë°˜í™”í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì…ë‹ˆë‹¤.

ìš”ì¦˜ì—ëŠ” ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¡œ í° ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ëŠ” ê²ƒì´ ì–¸ì–´ ëª¨ë¸ë§ ë“±ê³¼ ê°™ì€ ì˜ì—­ì—ì„œ ì¼ë°˜ì„±ì— í° ë„ì•½ì„ ê°€ëŠ¥í•˜ê²Œ í–ˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ í° ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ êµ¬ì²´í™”ëœ ì—ì´ì „íŠ¸ì˜ ì¼ë°˜ì„±ì„ í–¥ìƒì‹œí‚¤ëŠ” ë° ëŒ€í•œ ê´€ì‹¬ì´ ìƒê²¼ìŠµë‹ˆë‹¤. ì´ëŠ” ê³ ìˆ˜ì¤€ ì˜ì‚¬ ê²°ì •ì— ì–¸ì–´ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•(Driess et al. 2023; Huang et al. 2023)ì´ë‚˜ í° ëª¨ë¸ ìì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì œì–´ ì§€ì‹œë¥¼ ì¶œë ¥í•˜ëŠ” ë°©ë²•(Reed et al. 2022) ì¤‘ í•˜ë‚˜ë¡œ ì´ì–´ì§€ê¸°ë„ í•©ë‹ˆë‹¤. ë³¸ ì—°êµ¬ëŠ” í›„ìì˜ ì ‘ê·¼ë²•, êµ¬ì²´ì ìœ¼ë¡œëŠ” transformer sequence ëª¨ë¸ì„ ì œì–´ì— ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ì´ˆì ì„ ë§ì¶”ê³  ìˆìŠµë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ì´ì „ ì—°êµ¬ëŠ” ì •ì±… í•™ìŠµì„ ìœ„í•´ transformersë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•˜ì§€ë§Œ, ìš°ë¦¬ëŠ” ì´ë¥¼ ë™ì—­í•™ ëª¨ë¸ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì—°êµ¬í•˜ë©°, ì´ë¥¼ transformer ë™ì—­í•™ ëª¨ë¸(TDMs)ì´ë¼ê³  í•©ë‹ˆë‹¤. ì „í†µì ìœ¼ë¡œ ëª…ì‹œì ì¸ ë™ì—­í•™ ëª¨ë¸ì„ í•™ìŠµí•˜ê³  ì œì–´ì— ì‚¬ìš©í•˜ëŠ” ë™ê¸°ëŠ” ë™ì—­í•™ì´ ëª©í‘œì™€ ë…ë¦½ì ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë”°ë¼ì„œ í•™ìŠµëœ ë™ì—­í•™ ëª¨ë¸ì€ ë‹¤ì¤‘ ëª©í‘œì— ëŒ€í•œ ìµœì  ë™ì‘ì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì¬ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³¸ ì—°êµ¬ì—ì„œëŠ” ì¶”ê°€ì ì¸ ì¥ì ì„ ì¦ëª…í•©ë‹ˆë‹¤: íŠ¹ì • ìƒí™©ì—ì„œ ë™ì—­í•™ ëª¨ë¸ì€ ë™ì‘ ì •ì±…ë³´ë‹¤ ë³´ì´ì§€ ì•Šì€ í™˜ê²½ì— ëŒ€í•´ ë” ì¢‹ì€ ì¼ë°˜í™” ëŠ¥ë ¥ì„ ê°€ì§€ë¯€ë¡œ, ëª¨ë¸ì— ê¸°ë°˜í•œ ì¢…í•©ì ì¸ ì—ì´ì „íŠ¸ë¥¼ ìƒì„±í•˜ì—¬ ëª¨ë¸ ì—†ì´ í•™ìŠµí•œ ì—ì´ì „íŠ¸ë³´ë‹¤ ë” ì¢‹ì€ ì¼ë°˜í™”ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë…¼ë¬¸ì—ì„œ TDMsì˜ **ë‘ ê°€ì§€ ë‹¤ë¥¸ ì¸¡ë©´**ì„ ì‚´í´ë´…ë‹ˆë‹¤. ì²«ì§¸ë¡œ, ìš°ë¦¬ëŠ” ì „ë¬¸ê°€ ëª¨ë¸ í•™ìŠµ í™˜ê²½, ì¦‰ ëŒ€ìƒ í™˜ê²½ê³¼ì˜ ìƒí˜¸ì‘ìš©ìœ¼ë¡œ ì–»ì€ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í•™ìŠµí•  ë•Œ TDMsì˜ ì„±ëŠ¥ì´ ê¸°ì¤€ì„ ì— ë¹„í•´ ë” ì¢‹ìŒì„ ì¦ëª…í•©ë‹ˆë‹¤. ë‘˜ì§¸ë¡œ, ìš°ë¦¬ëŠ” TDMsê°€ í™˜ê²½ ê°„ì— ê°•ë ¥í•˜ê²Œ ì¼ë°˜í™”ë˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. íŠ¹íˆ, ìš°ë¦¬ëŠ” ì¢…í•©ì ì¸ TDMì´ ë³´ì´ì§€ ì•Šì€ í™˜ê²½ì— ëŒ€í•œ ëª‡ ê°€ì§€ ì‹œë„ ë˜ëŠ” ì œë¡œìƒ·(ì œë¡œ ìƒ·) ì¼ë°˜í™”ì— ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. 



1. We use transformer sequence models as TDMs for control, and we describe a simple setup to evaluate learned models in an MPC loop together with a random shooting planner. 
2. In the specialist setting, i.e., when trained on transition data from the target environment, we observe that TDMs are accurate, and outperform baseline models (see section 5.1). 
3. In the generalist setting, i.e., when trained on transition data from environments different from the target environment, we find strong generalization capabilities, both few-shot and zero-shot: 
   1. (a) In a few-shot setting (fine-tuning a generalist), we observe strong generalization effects, which can be exploited to obtain a good dynamics model given limited data. In our experiments, this approach surpasses even lightweight specialist models (see section 5.2.1). 
   2. (b) In a zero-shot setting, we observe that the generalist TDM generalizes substantially better than its generalist policy counterpart (see section 5.2.2). 




---

# Background

## Modelling trajectory data with transformers

ë„ì… ë¶€ë¶„ì—ì„œ íŒŒì•…í–ˆë˜ Recovery taskì˜ íŠ¹ì„±ê³¼ poseë“¤ ê°„ì˜ ê±°ë¦¬ë¥¼ ìœ„í•œ ìƒˆë¡œìš´ metricì˜ í•„ìš”ì„±ì„ `motivation`ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ `contribution`ì„ íŒŒì•…í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- Euclidean distanceë³´ë‹¤ ì œì–´ì ì¸ ì¸¡ë©´ì—ì„œ poseë“¤ ê°„ì˜ ê±°ë¦¬ metricì´ ë  ìˆ˜ ìˆëŠ” **Accessibility** ë¥¼ ì œì•ˆ

- Accessibilityë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°•í™”í•™ìŠµì„ íš¨ìœ¨ì ìœ¼ë¡œ í•  ìˆ˜ ìˆë„ë¡(State Space íƒìƒ‰ì„ ì˜í•˜ë„ë¡) Initial Stateë¥¼ ì •í•  ìˆ˜ ìˆëŠ” **K-Access ì•Œê³ ë¦¬ì¦˜**ì„ ì œì•ˆ

## Model Predictive Control (MPC)

---


# Method

**Overview**

![](../../images/2023-05-07-accessibility/9.png)

ì „ì²´ì ì¸ ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ì´ í¬ê²Œ 4ë‹¨ê³„ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.

1. **Sampling Static Poses**: ì „ë³µëœ ì •ì  ìì„¸ë¥¼ ìƒ˜í”Œë§í•©ë‹ˆë‹¤.
2. **Estimating Accessibility Values**: ìƒ˜í”Œë§ëœ ì „ë³µ ìì„¸ë“¤ ê°„ì˜ ê±°ë¦¬ metricì¸ Accessibility Matrixë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
3. **Clustering**: ì¸¡ì •í•œ Accessibilityë¥¼ ê¸°ë°˜ìœ¼ë¡œ Initial stateë“¤ì„ í´ëŸ¬ìŠ¤í„°ë§í•©ë‹ˆë‹¤.
4. **Learning**: Clusterì˜ Centroid poseë¥¼ initial stateë¡œ Recovery(í˜¹ì€ Backflip)ì„ ê°•í™”í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ í•™ìŠµí•©ë‹ˆë‹¤.


## MPC

ì „ë³µëœ ë‹¤ì–‘í•œ ìì„¸ë“¤ì„ ìƒ˜í”Œë§í•˜ê¸° ìœ„í•´ì„œ ë¡œë´‡ì˜ base frameì˜ roll, pitch ê°ë„ë¥¼ ì¼ì • ë²”ìœ„ì—ì„œ ëœë¤í•˜ê²Œ ìƒ˜í”Œë§í•˜ê³  12ê°œì˜ joint positionë„ ë¡œë´‡ì˜ configurationì„ ê³ ë ¤í•˜ì—¬ upper/lower limit rangeì— ìˆëŠ” ê°ë„ë¡œ ìì„¸ë¥¼ setí•´ì„œ ì „ë³µëœ ìì„¸ë¥¼ ë§Œë“­ë‹ˆë‹¤. (ì´ë•Œ yaw ë°©í–¥ì€ flat terrainì—ì„  ì˜ë¯¸ê°€ ì—†ê¸° ë•Œë¬¸ì— 0ìœ¼ë¡œ ì…‹íŒ…í•©ë‹ˆë‹¤.) ìƒ˜í”Œë§ëœ ìì„¸ë¡œ poseë¥¼ set í–ˆì„ ë•Œ self-collisionì„ í™•ì¸í•œ ë’¤ self-collisionì´ ë˜ì§€ ì•Šì€ ìì„¸ 2.4kê°œë¥¼ sampling í•©ë‹ˆë‹¤.

![ì˜ˆì‹œ ì‚¬ì§„ì€ í•´ë‹¹ ë…¼ë¬¸ì˜ ì½”ë“œë¥¼ ì—°êµ¬ì‹¤ì—ì„œ ê°œë°œëœ AiDIN-VIII ë¡œë´‡ì— ì ìš©í•œ ëª¨ìŠµì…ë‹ˆë‹¤](../../images/2023-05-07-accessibility/10.png)


## Training Setups



## Environments


---

**Clustering Analysis**


<center>
<img src="../../images/2023-05-07-accessibility/22.png" alt="22" width="67%" />
<img src="../../images/2023-05-07-accessibility/23.png" alt="23" width="67%" />
    <figcaption>Lecture 16 - Radial Basis Functions Slides(Caltech)</figcaption>
</center>

`ë”°ë¼ì„œ ì´ ë¶€ë¶„ì€ RBF ì»¤ë„ì— ëŒ€í•´ ê³µë¶€í•˜ê³  ë‚˜ì„œ ì œê°€ ìƒê°í•œ ì´ìœ ë¥¼ ë§ë¶™ì´ê² ìŠµë‹ˆë‹¤.` RBF ì»¤ë„ì€ ê¸°ë³¸ì ìœ¼ë¡œ Gaussian Distribution ëª¨ìŠµìœ¼ë¡œ target valueì™€ data ê°„ì˜ radialí•œ ê±°ë¦¬ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ê²Œ ë˜ëŠ”ë°, linear sumê³¼ ë¹„êµí–ˆì„ ë•Œ ë¬´í•œ ì°¨ì› ì˜ì—­ì—ì„œ ë§¤ìš° ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆëŠ” dataë¡œë¶€í„° ì˜í–¥ì„ ëœ ë°›ì„ ìˆ˜ ìˆëŠ” ì¥ì ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ Rewardë¥¼ ê³„ì‚°í•˜ëŠ” ë°ì— RBF ì»¤ë„ì„ í†µí•´ ê³„ì‚°í•œ ì˜ë„ëŠ” Maximizationí•´ì•¼ í•˜ëŠ” Reward termë“¤ì„ ë‹¨ìˆœíˆ Linear sumí•˜ëŠ” ê²ƒë³´ë‹¤ ì—¬ëŸ¬ ì¹´í…Œê³ ë¦¬ì˜ Reward target ê°’ë“¤ì— ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•  ìˆ˜ ìˆëŠ” ì •ë„ë¥¼ $\alpha$ê°’(Slideì—ì„œëŠ” $\gamma$ë¡œ í‘œí˜„)ì„ ì´ìš©í•˜ì—¬ í•™ìŠµì˜ ì¢‹ì€ ì§€í‘œê°€ ë  ìˆ˜ ìˆëŠ” Reward spaceë¥¼ ì„¤ê³„í•œ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.

> Reward Termì—ì„œ ì‚¬ìš©ëœ Symbolì˜ ì˜ë¯¸ê°€ ê¶ê¸ˆí•˜ì‹  ë¶„ë“¤ì€ ì•„ë˜ tableì„ í™•ì¸í•´ì£¼ì„¸ìš”.

<details>
<summary><b>Symbols of Reward Terms for DRL</b></summary>
<img width="100%" src="../../images/2023-05-07-accessibility/15.png" title="Cost Table" />
</details>

---

**Other Tasks - Backflip**

í•´ë‹¹ ë…¼ë¬¸ì—ì„œëŠ” Recovery ë¿ë§Œ ì•„ë‹ˆë¼ Locomotion ë³´ë‹¤ ë” ë‹¤ì´ë‚˜ë¯¹í•œ ëª¨ì…˜ë„ í•™ìŠµí•˜ëŠ” ê²ƒì„ ë³´ì—¬ì£¼ê¸° ìœ„í•´ Backflip í•™ìŠµë„ K-Accessibility ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•˜ì—¬ í•™ìŠµì„ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤. (ì´ì „ì— ë¦¬ë·°í–ˆë˜ [WASABI](https://curieuxjy.github.io/posts/paper/2023-03-12-wasabi.html) ë…¼ë¬¸ì—ì„œë„ ë‹¤ì´ë‚˜ë¯¹í•œ ëª¨ì…˜ 4ê°€ì§€ ì¤‘ í•˜ë‚˜ë¥¼ Backflipìœ¼ë¡œ í•™ìŠµ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ì—ˆë˜ ê²ƒê³¼ ê°™ì€ ë§¥ë½ìœ¼ë¡œ í•´ë‹¹ ëª¨ì…˜ Taskë¥¼ ì„¤ì •í–ˆë‹¤ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤.)


---

# Experiments


::: {.callout-note collapse="true" icon="false"}

## Backflip Task

![](../../images/2023-05-07-accessibility/20.png)

![](../../images/2023-05-07-accessibility/18.png)

:::

# Discussion & Conclusion


# Reference

- [Original Paper: A Generalist Dynamics Model for Control](https://arxiv.org/abs/2305.10912)